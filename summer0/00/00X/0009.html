<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Alison</title>
</head>
<body>

<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

<script>

    d3.json("/WebstormProjects/summer/member.json",function(error,root) {


        if (error) {
            return console.log(error);
        }
        console.log(root);



        var u=window.location.href;
        var ur=u.split('?')[1];
        var url=ur.split('=')[1];
        console.log(url);
        var urlf=url.replace(/_/g, ' ');
        console.log(urlf);

        //把每一个title中的member都变成一个2个元素的数组
        // 得到的dale分别给每个数组相比
        //匹配了就得出这个i
        //通过这个i获得  title



        var a=[];
        var b="";
        var c=0;
        var e=[];
        var l=0;
        var counter=0;

//        for (i = 0; i < root.length; i++) {



        for(i=0;i<root.length;i++){

            if (root[i]["Members"].match(/,/)){

                var b=root[i]["Members"].split(',');


                console.log(b);

//************************************************************************************
                for (bi in b){

                    if (urlf==b[bi]){
                        e.push({"mi":counter,"Title":root[i]["Title"]});
                        break;
                    }
                }

                //直接在for 循环中的if里面 写这个for循环, 所有  就不用像下面那样写了


//**********************************************************************************

//        for (bi in b){
//            a.push({"mi":c,"name":b[bi]});
//            c=c+1;
//            console.log(a);
//
//        }
//
//
//
//        for (l=0;l< a.length;l++){
//            if(urlf==a[l].name){
//                e.push({"mi":counter,"Title":root[i]["Title"]});
//                counter=counter+1;
//            }
//
//            a=[];
//            b="";
//            //把a,b 每次清零,   但是不停往e中放东西!!!!!
//
//        }



            }else{
                if (root[i]["Members"]==urlf){
                    e.push({"mi":counter,"Title":root[i]["Title"]});
                    counter=counter+1;
                }
            }






        }

        console.log(e);



        var force = d3.layout.force()
                .nodes(e)

                .size([800,700])//  靠这个来控制pop up 出来的 位置~

                .charge(-200)
                .start();








    })





</script>

</body>
</html>